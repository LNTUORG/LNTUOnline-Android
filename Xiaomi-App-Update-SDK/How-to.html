<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="zh-CN">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="zh-CN">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="zh-CN">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>检查更新SDK 集成指南 | 小米应用开发者文档</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://dev.xiaomi.com/doc/xmlrpc.php" />
<!--[if lt IE 9]>
<script src="http://dev.xiaomi.com/doc/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="小米应用开发者文档 &raquo; Feed" href="http://dev.xiaomi.com/doc/?feed=rss2" />
<link rel="alternate" type="application/rss+xml" title="小米应用开发者文档 &raquo; 评论Feed" href="http://dev.xiaomi.com/doc/?feed=comments-rss2" />
<link rel='stylesheet' id='admin-bar-css'  href='http://dev.xiaomi.com/doc/wp-includes/css/admin-bar.min.css?ver=3.7' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-fonts-css'  href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&#038;subset=latin,latin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-style-css'  href='http://dev.xiaomi.com/doc/wp-content/themes/twentytwelve/style.css?ver=3.7' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://dev.xiaomi.com/doc/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://dev.xiaomi.com/doc/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://dev.xiaomi.com/doc/wp-includes/wlwmanifest.xml" /> 
<link rel='next' title='检查更新SDK 常见问题FAQ' href='http://dev.xiaomi.com/doc/?p=32' />
<meta name="generator" content="WordPress 3.7" />
<link rel='canonical' href='http://dev.xiaomi.com/doc/?p=26' />
<link rel='shortlink' href='http://dev.xiaomi.com/doc/?p=26' />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #e6e6e6; }
</style>
<style type="text/css" media="print">#wpadminbar { display:none; }</style>
<style type="text/css" media="screen">
	html { margin-top: 28px !important; }
	* html body { margin-top: 28px !important; }
</style>
</head>

<body class="single single-post postid-26 single-format-standard logged-in admin-bar no-customize-support custom-background custom-font-enabled">
<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
		<hgroup>
			<h1 class="site-title"><a href="http://dev.xiaomi.com/doc/" title="小米应用开发者文档" rel="home">小米应用开发者文档</a></h1>
			<h2 class="site-description">为应用开发者提供开发、发布和功能支持文档</h2>
		</hgroup>

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<h3 class="menu-toggle">菜单</h3>
			<a class="assistive-text" href="#content" title="跳至内容">跳至内容</a>
			<div class="menu-%e9%87%8d%e8%a6%81%e9%93%be%e6%8e%a5-container"><ul id="menu-%e9%87%8d%e8%a6%81%e9%93%be%e6%8e%a5" class="nav-menu"><li id="menu-item-270" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-270"><a href="http://developer.xiaomi.com/doc">文档首页</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19"><a href="http://developer.xiaomi.com">小米开发者站</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20"><a href="http://www.miui.com/forum.php?mod=forumdisplay&#038;fid=231&#038;page=1&#038;filter=typeid&#038;typeid=1458">MIUI论坛开发者专区</a></li>
<li id="menu-item-24" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a href="http://dev.xiaomi.com/doc/?page_id=22">联系我们</a></li>
</ul></div>		</nav><!-- #site-navigation -->

			</header><!-- #masthead -->

	<div id="main" class="wrapper">
	<div id="primary" class="site-content">
		<div id="content" role="main">

			
				
	<article id="post-26" class="post-26 post type-post status-publish format-standard hentry category-technical category-featured">
				<header class="entry-header">
									<h1 class="entry-title">检查更新SDK 集成指南</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p>如果您在集成过程中遇到任何问题，都可以邮件至<a href="mailto:developer@xiaomi.com">developer@xiaomi.com</a> ，我们会尽快答复您</p>
<p>小米应用商店检查更新SDK(下文简写为『检查更新SDK』)帮助您的用户尽快获得最新版本的应用！轻松增加『自动检查更新』功能，通过小米应用商店的CDN服务，快速的把最新版应用推送给用户！</p>
<h2>功能特点：</h2>
<ul>
<li>支持增量更新：检查更新SDK会自动识别用户版本，并提供diff包给用户，加速省流</li>
<li>一次发布全面更新：只要在小米应用商店发布新版，所有的用户都可以收到新版发布提醒。</li>
<li>标准Android SDK：无论用户是否使用MIUI，都可以收到更新提醒。</li>
<li>方便省心：无需考虑配置服务器，部署CDN等问题，小米应用商店免费提供。</li>
<li>支持基于设备属性和API-Level的系统版本过滤，会将新版推送给支持的设备。</li>
<li>独家支持：在MIUI系统上支持调用系统商店更新，升级成功率更高！</li>
</ul>
<h2>立即开始集成：</h2>
<p><a href="http://file.market.xiaomi.com/download/AppStore/c5c70cdb-beaa-4939-a660-78cf33240045/Xiaomi_App_update_SDK_0.2_with_doc.zip">点此下载SDK包</a> ( 2013年12月11日更新 内附集成文档 )</p>
<h3>1. 在工程中加入检查更新SDK</h3>
<h4>添加jar包</h4>
<pre><code>下载最新版SDK的zip包并解压缩，将其中的libs 文件夹合并到本地工程libs子目录下。
Eclipse用户右键工程根目录，选择Properties -&gt; Java Build Path -&gt; Libraries，然后点击Add External JARs... 选择指向xiaomi_sdk.jar的路径，点击OK，即导入成功。
</code></pre>
<h4>添加资源文件</h4>
<pre><code>将SDK提供的res文件夹拷入工程目录下, 和工程本身res目录合并。
请注意: 小米SDK提供的资源文件都以xiaomi_开头。
</code></pre>
<h3>2. 在AndroidManifest.xml文件中添加SDK信息</h3>
<h4>添加检查更新需要的权限</h4>
<pre><code>打开AndroidManifest.xml，添加SDK需要的权限到&lt;manifest&gt;标签下：
&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /&gt;
&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;
&lt;uses-permission android:name="android.permission.INTERNET" /&gt;
&lt;uses-permission android:name="android.permission.ACCESS_WIFI_STATE" /&gt;
&lt;uses-permission android:name="android.permission.READ_PHONE_STATE" /&gt;
&lt;uses-permission android:name="com.xiaomi.market.sdk.UPDATE" /&gt;
</code></pre>
<h4>添加Receiver</h4>
<pre><code>&lt;receiver android:name="com.xiaomi.market.sdk.DownloadCompleteReceiver" &gt;
&lt;intent-filter&gt;
&lt;action android:name="android.intent.action.DOWNLOAD_COMPLETE" /&gt;
&lt;/intent-filter&gt;
&lt;/receiver&gt;
</code></pre>
<p>说明：SDK调用系统下载管理器进行下载，需要注册receiver，在下载完成后进行增量包合成与安装</p>
<h3>3. 集成SDK代码</h3>
<h4>在应用程序入口Activity里的OnCreate() 方法中调用</h4>
<pre><code>public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
XiaomiUpdateAgent.update(this);
</code></pre>
<p>API：</p>
<pre><code>- public void update(Context context)
</code></pre>
<h2>Done! 集成成功!</h2>
<p>现在只要在小米应用商店发布应用，您的用户就会收到更新提醒了！</p>
<p>Tips:</p>
<ol>
<li>新版本App要在小米应用商店上架之后，才能检查到更新</li>
<li>考虑到集成检查更新SDK的版本分发也需要时间，建议您尽早集成</li>
</ol>
<h2>常见问题 FAQ：</h2>
<ul>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q1">如何测试集成是否成功?</a></li>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q2">如何设置仅在WiFi下检查更新?</a></li>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q3">我希望自己设计提醒样式，如何手动处理回调？</a></li>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q4">检查更新SDK如何检查新版本？</a></li>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q5">混淆中遇到问题怎么处理？</a></li>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q6">检查更新SDK申请的权限对应哪些功能？</a></li>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q7">有时候测试发现并不是增量升级包是为什么？</a></li>
<li><a href="http://developer.xiaomi.com/doc/?p=32#q8">增量更新有哪些要求？</a></li>
</ul>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			<!--?php twentytwelve_entry_meta(); ?-->
			<span class="edit-link"><a class="post-edit-link" href="http://dev.xiaomi.com/doc/wp-admin/post.php?post=26&amp;action=edit">编辑</a></span>					</footer><!-- .entry-meta -->
	</article><!-- #post -->

				<nav class="nav-single">
					<h3 class="assistive-text">文章导航</h3>
					<span class="nav-previous"></span>
					<span class="nav-next"><a href="http://dev.xiaomi.com/doc/?p=32" rel="next">检查更新SDK 常见问题FAQ <span class="meta-nav">&rarr;</span></a></span>
				</nav><!-- .nav-single -->

				

			
		</div><!-- #content -->
	</div><!-- #primary -->


			<div id="secondary" class="widget-area" role="complementary">
			<aside id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://dev.xiaomi.com/doc/">
				<div>
					<label class="screen-reader-text" for="s">搜索：</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="搜索" />
				</div>
			</form></aside><aside id="categories-3" class="widget widget_categories"><h3 class="widget-title">目录</h3>		<ul>
	<li class="cat-item cat-item-2"><a href="http://dev.xiaomi.com/doc/?cat=2" title="小米应用商店开发者站的公告">公告</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://dev.xiaomi.com/doc/?cat=3" title="如何在小米应用商店分发应用">分发与审核</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://dev.xiaomi.com/doc/?cat=7" title="查看常见问题与解答下的所有文章">常见问题与解答</a>
</li>
	<li class="cat-item cat-item-10"><a href="http://dev.xiaomi.com/doc/?cat=10" title="应用提交FAQ">应用提交常见问题</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://dev.xiaomi.com/doc/?cat=1" title="查看技术文档下的所有文章">技术文档</a>
</li>
	<li class="cat-item cat-item-9"><a href="http://dev.xiaomi.com/doc/?cat=9" title="注册FAQ">注册常见问题</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://dev.xiaomi.com/doc/?cat=6" title="查看特色功能下的所有文章">特色功能</a>
</li>
		</ul>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">新近发布</h3>		<ul>
					<li>
				<a href="http://dev.xiaomi.com/doc/?p=1958">小米结构化存储开发文档</a>
						</li>
					<li>
				<a href="http://dev.xiaomi.com/doc/?p=1925">开发者账号信息修改操作流程</a>
						</li>
					<li>
				<a href="http://dev.xiaomi.com/doc/?p=1897">一键下载到小米路由器</a>
						</li>
					<li>
				<a href="http://dev.xiaomi.com/doc/?p=1675">小米电视/小米盒子设备规格</a>
						</li>
					<li>
				<a href="http://dev.xiaomi.com/doc/?p=1621">推送服务接入指南</a>
						</li>
				</ul>
		</aside>		</div><!-- #secondary -->
		</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
						<a href="http://cn.wordpress.org/" title="优雅的个人发布平台">自豪地采用WordPress</a>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type='text/javascript' src='http://dev.xiaomi.com/doc/wp-includes/js/admin-bar.min.js?ver=3.7'></script>
<script type='text/javascript' src='http://dev.xiaomi.com/doc/wp-content/themes/twentytwelve/js/navigation.js?ver=1.0'></script>
	<script type="text/javascript">
		(function() {
			var request, b = document.body, c = 'className', cs = 'customize-support', rcs = new RegExp('(^|\\s+)(no-)?'+cs+'(\\s+|$)');

			request = true;

			b[c] = b[c].replace( rcs, ' ' );
			b[c] += ( window.postMessage && request ? ' ' : ' no-' ) + cs;
		}());
	</script>
			<div id="wpadminbar" class="nojq nojs" role="navigation">
			<a class="screen-reader-shortcut" href="#wp-toolbar" tabindex="1">跳至工具栏</a>
			<div class="quicklinks" id="wp-toolbar" role="navigation" aria-label="顶部导航工具栏。" tabindex="0">
				<ul id="wp-admin-bar-root-default" class="ab-top-menu">
		<li id="wp-admin-bar-wp-logo" class="menupop"><a class="ab-item"  aria-haspopup="true" href="http://dev.xiaomi.com/doc/wp-admin/about.php" title="关于WordPress"><span class="ab-icon"></span></a><div class="ab-sub-wrapper"><ul id="wp-admin-bar-wp-logo-default" class="ab-submenu">
		<li id="wp-admin-bar-about"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/about.php">关于WordPress</a>		</li></ul><ul id="wp-admin-bar-wp-logo-external" class="ab-sub-secondary ab-submenu">
		<li id="wp-admin-bar-wporg"><a class="ab-item"  href="http://cn.wordpress.org/">WordPress.org</a>		</li>
		<li id="wp-admin-bar-documentation"><a class="ab-item"  href="http://codex.wordpress.org/zh-cn:Main_Page">文档</a>		</li>
		<li id="wp-admin-bar-support-forums"><a class="ab-item"  href="http://zh-cn.forums.wordpress.org/">支持论坛</a>		</li>
		<li id="wp-admin-bar-feedback"><a class="ab-item"  href="http://zh-cn.forums.wordpress.org/forum/suggestions">反馈</a>		</li></ul></div>		</li>
		<li id="wp-admin-bar-site-name" class="menupop"><a class="ab-item"  aria-haspopup="true" href="http://dev.xiaomi.com/doc/wp-admin/">小米应用开发者文档</a><div class="ab-sub-wrapper"><ul id="wp-admin-bar-site-name-default" class="ab-submenu">
		<li id="wp-admin-bar-dashboard"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/">仪表盘</a>		</li></ul><ul id="wp-admin-bar-appearance" class="ab-submenu">
		<li id="wp-admin-bar-themes"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/themes.php">主题</a>		</li>
		<li id="wp-admin-bar-customize" class="hide-if-no-customize"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/customize.php?url=http%3A%2F%2Fdev.xiaomi.com%2Fdoc%2F%3Fp%3D26">自定义</a>		</li>
		<li id="wp-admin-bar-widgets"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/widgets.php">小工具</a>		</li>
		<li id="wp-admin-bar-menus"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/nav-menus.php">菜单</a>		</li>
		<li id="wp-admin-bar-background"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/themes.php?page=custom-background">背景</a>		</li>
		<li id="wp-admin-bar-header"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/themes.php?page=custom-header">顶部</a>		</li></ul></div>		</li>
		<li id="wp-admin-bar-updates"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/update-core.php" title="3个主题更新, 翻译更新"><span class="ab-icon"></span><span class="ab-label">4</span><span class="screen-reader-text">3个主题更新, 翻译更新</span></a>		</li>
		<li id="wp-admin-bar-comments"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/edit-comments.php" title="0条评论待审"><span class="ab-icon"></span><span id="ab-awaiting-mod" class="ab-label awaiting-mod pending-count count-0">0</span></a>		</li>
		<li id="wp-admin-bar-new-content" class="menupop"><a class="ab-item"  aria-haspopup="true" href="http://dev.xiaomi.com/doc/wp-admin/post-new.php" title="添加"><span class="ab-icon"></span><span class="ab-label">新建</span></a><div class="ab-sub-wrapper"><ul id="wp-admin-bar-new-content-default" class="ab-submenu">
		<li id="wp-admin-bar-new-post"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/post-new.php">文章</a>		</li>
		<li id="wp-admin-bar-new-media"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/media-new.php">媒体</a>		</li>
		<li id="wp-admin-bar-new-page"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/post-new.php?post_type=page">页面</a>		</li>
		<li id="wp-admin-bar-new-user"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/user-new.php">用户</a>		</li></ul></div>		</li>
		<li id="wp-admin-bar-edit"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/post.php?post=26&#038;action=edit">编辑文章</a>		</li></ul><ul id="wp-admin-bar-top-secondary" class="ab-top-secondary ab-top-menu">
		<li id="wp-admin-bar-search" class="admin-bar-search"><div class="ab-item ab-empty-item" tabindex="-1"><form action="http://dev.xiaomi.com/doc/" method="get" id="adminbarsearch"><input class="adminbar-input" name="s" id="adminbar-search" type="text" value="" maxlength="150" /><input type="submit" class="adminbar-button" value="搜索"/></form></div>		</li>
		<li id="wp-admin-bar-my-account" class="menupop with-avatar"><a class="ab-item"  aria-haspopup="true" href="http://dev.xiaomi.com/doc/wp-admin/profile.php" title="我的帐户">您好，Art, Webto<img alt='' src='http://0.gravatar.com/avatar/8b22299d7b66ff82916696d5e70b0d8c?s=16&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D16&amp;r=G' class='avatar avatar-16 photo' height='16' width='16' /></a><div class="ab-sub-wrapper"><ul id="wp-admin-bar-user-actions" class="ab-submenu">
		<li id="wp-admin-bar-user-info"><a class="ab-item" tabindex="-1" href="http://dev.xiaomi.com/doc/wp-admin/profile.php"><img alt='' src='http://0.gravatar.com/avatar/8b22299d7b66ff82916696d5e70b0d8c?s=64&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D64&amp;r=G' class='avatar avatar-64 photo' height='64' width='64' /><span class='display-name'>Art, Webto</span><span class='username'>wangbo</span></a>		</li>
		<li id="wp-admin-bar-edit-profile"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-admin/profile.php">编辑我的个人资料</a>		</li>
		<li id="wp-admin-bar-logout"><a class="ab-item"  href="http://dev.xiaomi.com/doc/wp-login.php?action=logout&#038;_wpnonce=a0d087d933">登出</a>		</li></ul></div>		</li></ul>			</div>
						<a class="screen-reader-shortcut" href="http://dev.xiaomi.com/doc/wp-login.php?action=logout&#038;_wpnonce=a0d087d933">登出</a>
					</div>

		<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32956769-4', 'xiaomi.com');
  ga('send', 'pageview');

</script>
</body>
</html>